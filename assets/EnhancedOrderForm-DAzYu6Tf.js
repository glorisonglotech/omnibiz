import{j as e}from"./radix-vendor-B3KJ3-F4.js";import{r as f}from"./react-vendor-DyCm8Hca.js";import{p as U,q as A,r as $,s as B,t as V,S as K,L as t,I as d,u as b,o as z,B as N,v as x,w as u,x as j,y as g,z as i,A as L,E as R}from"./index-QRwVLPK4.js";import{e as Q,u as C,M as w,v as H,w as _,P as G,o as J,j as W,T as X,g as Y,B as P,x as Z,D as ee,y as se,t as o}from"./ui-vendor-7Lw9ZtLE.js";import"./socket-vendor-CA1CrNgP.js";import"./chart-vendor-DSBLL5zb.js";const de=({isOpen:M,onClose:S,onSubmit:O,initialData:k=null,products:ae=[],mode:y="add"})=>{const[a,m]=f.useState(k||{supplier:{name:"",email:"",phone:"",address:""},items:[],total:0,status:"Pending",paymentStatus:"Unpaid",paymentMethod:"",shippingMethod:"",notes:"",date:new Date().toISOString().split("T")[0],notificationMethod:"email"}),[l,p]=f.useState({name:"",sku:"",price:0,quantity:1});f.useEffect(()=>{const s=a.items.reduce((r,n)=>r+n.price*n.quantity,0);m(r=>({...r,total:s}))},[a.items]);const c=(s,r)=>{if(s.includes(".")){const[n,h]=s.split(".");m(v=>({...v,[n]:{...v[n],[h]:r}}))}else m(n=>({...n,[s]:r}))},F=()=>{if(!l.name||!l.sku){o.error("Product name and SKU are required");return}if(l.price<=0){o.error("Price must be greater than 0");return}if(l.quantity<1){o.error("Quantity must be at least 1");return}m(s=>({...s,items:[...s.items,{productId:`manual-${Date.now()}`,name:l.name,sku:l.sku,price:Number(l.price),quantity:Number(l.quantity),image:null}]})),p({name:"",sku:"",price:0,quantity:1}),o.success(`Added ${l.name} to order`)},D=s=>{m(r=>({...r,items:r.items.filter((n,h)=>h!==s)})),o.info("Item removed from order")},q=(s,r)=>{r<1||m(n=>({...n,items:n.items.map((h,v)=>v===s?{...h,quantity:r}:h)}))},E=async()=>{if(!a.supplier.name||!a.supplier.email){o.error("Supplier name and email are required");return}if(a.items.length===0){o.error("Please add at least one item to the order");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.supplier.email)){o.error("Please enter a valid email address");return}await O(a)},I=[{value:"Pending",color:"bg-yellow-500"},{value:"Processing",color:"bg-blue-500"},{value:"Shipped",color:"bg-purple-500"},{value:"Delivered",color:"bg-green-500"},{value:"Cancelled",color:"bg-red-500"}],T=[{value:"Unpaid",color:"bg-red-500"},{value:"Partial",color:"bg-yellow-500"},{value:"Paid",color:"bg-green-500"}];return e.jsx(U,{open:M,onOpenChange:S,children:e.jsxs(A,{className:"max-w-5xl max-h-[90vh] overflow-hidden",children:[e.jsxs($,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),y==="add"?"Create Supplier Order":"Edit Supplier Order"]}),e.jsx(V,{children:y==="add"?"Place an order to your supplier - enter supplier details and products":"Update supplier order information and status"})]}),e.jsx(K,{className:"max-h-[calc(90vh-180px)] pr-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),"Supplier Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"supplier-name",className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),"Supplier Name *"]}),e.jsx(d,{id:"supplier-name",placeholder:"ABC Supplies Ltd",value:a.supplier.name,onChange:s=>c("supplier.name",s.target.value),className:"border-primary/30 focus:border-primary"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"supplier-email",className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Email *"]}),e.jsx(d,{id:"supplier-email",type:"email",placeholder:"supplier@example.com",value:a.supplier.email,onChange:s=>c("supplier.email",s.target.value),className:"border-primary/30 focus:border-primary"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"supplier-phone",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"Phone"]}),e.jsx(d,{id:"supplier-phone",type:"tel",placeholder:"+1 (555) 000-0000",value:a.supplier.phone,onChange:s=>c("supplier.phone",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"supplier-address",className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Address"]}),e.jsx(d,{id:"supplier-address",placeholder:"123 Main St, City, State",value:a.supplier.address,onChange:s=>c("supplier.address",s.target.value)})]})]})]}),e.jsx(b,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),"Order Items (",a.items.length,")"]}),e.jsxs(z,{variant:"secondary",className:"text-lg font-bold",children:["Total: $",a.total.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-accent/30 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium",children:"Add Product Manually"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-xs",children:"Product Name *"}),e.jsx(d,{placeholder:"e.g., Office Chair",value:l.name,onChange:s=>p({...l,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-xs",children:"SKU/Code *"}),e.jsx(d,{placeholder:"e.g., SKU-001",value:l.sku,onChange:s=>p({...l,sku:s.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-xs",children:"Unit Price *"}),e.jsx(d,{type:"number",min:"0",step:"0.01",placeholder:"0.00",value:l.price,onChange:s=>p({...l,price:s.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(t,{className:"text-xs",children:"Quantity *"}),e.jsx(d,{type:"number",min:"1",value:l.quantity,onChange:s=>p({...l,quantity:s.target.value})})]})]}),e.jsxs(N,{onClick:F,className:"w-full gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"Add Product to Order"]})]}),a.items.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-accent/20 rounded-lg",children:[e.jsx(W,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No items added yet"}),e.jsx("p",{className:"text-xs mt-1",children:'Enter product details above and click "Add Product to Order"'})]}):e.jsx("div",{className:"space-y-2",children:a.items.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-card border rounded-lg hover:shadow-md transition-shadow",children:[s.image&&e.jsx("img",{src:s.image,alt:s.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["SKU: ",s.sku]}),e.jsxs("p",{className:"text-sm font-bold text-primary",children:["$",s.price.toFixed(2)," each"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{type:"number",min:"1",value:s.quantity,onChange:n=>q(r,Number(n.target.value)),className:"w-20"}),e.jsxs("span",{className:"text-sm font-semibold w-20 text-right",children:["$",(s.price*s.quantity).toFixed(2)]}),e.jsx(N,{variant:"destructive",size:"icon",onClick:()=>D(r),children:e.jsx(X,{className:"h-4 w-4"})})]})]},r))})]}),e.jsx(b,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),"Order Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"order-date",children:"Order Date"}),e.jsx(d,{id:"order-date",type:"date",value:a.date,onChange:s=>c("date",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"payment-method",children:"Payment Method"}),e.jsxs(x,{value:a.paymentMethod,onValueChange:s=>c("paymentMethod",s),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select method"})}),e.jsxs(g,{children:[e.jsx(i,{value:"Cash",children:"Cash"}),e.jsx(i,{value:"Card",children:"Credit/Debit Card"}),e.jsx(i,{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx(i,{value:"Mobile Money",children:"Mobile Money"}),e.jsx(i,{value:"Other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"order-status",children:"Order Status"}),e.jsxs(x,{value:a.status,onValueChange:s=>c("status",s),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsx(g,{children:I.map(s=>e.jsx(i,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.color}`}),s.value]})},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"payment-status",children:"Payment Status"}),e.jsxs(x,{value:a.paymentStatus,onValueChange:s=>c("paymentStatus",s),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsx(g,{children:T.map(s=>e.jsx(i,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.color}`}),s.value]})},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"shipping-method",children:"Shipping Method"}),e.jsxs(x,{value:a.shippingMethod,onValueChange:s=>c("shippingMethod",s),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select method"})}),e.jsxs(g,{children:[e.jsx(i,{value:"Standard",children:"Standard Shipping"}),e.jsx(i,{value:"Express",children:"Express Shipping"}),e.jsx(i,{value:"Overnight",children:"Overnight"}),e.jsx(i,{value:"Pickup",children:"Store Pickup"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"notification-method",className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Supplier Notification Method"]}),e.jsxs(x,{value:a.notificationMethod,onValueChange:s=>c("notificationMethod",s),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select notification method"})}),e.jsxs(g,{children:[e.jsx(i,{value:"email",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Email"]})}),e.jsx(i,{value:"sms",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"SMS"]})}),e.jsx(i,{value:"both",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Email & SMS"]})})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose how you want to notify the supplier about this order"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"notes",children:"Order Notes"}),e.jsx(L,{id:"notes",placeholder:"Special instructions, delivery notes, etc...",value:a.notes,onChange:s=>c("notes",s.target.value),className:"resize-none h-20"})]})]})]})}),e.jsxs(R,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["Total: $",a.total.toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{variant:"outline",onClick:S,children:"Cancel"}),e.jsxs(N,{onClick:E,className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),y==="add"?"Create Order":"Update Order"]})]})]})]})})};export{de as default};
